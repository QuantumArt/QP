# Описание БД QP8.CMS

## Общие сведения

Данный документ описывает структуру БД системы **QP8.CMS** (далее QP8). Система поддерживает следующие СУБД:

* SQL Server 2012 (или выше)
* PostgreSQL (или PostgresPro) 12 (или выше)

### Права доступа

#### SQL Server

Пользователь, под которым работает QP8, должен либо входить в роль `db_owner`, либо одновременно входить в роли `db_datareader`, `db_datawriter` и иметь права доступа `EXECUTE` на все хранимые процедуры и функции, определенные в системе.

Если в системе определены виртуальные контенты, получающие информацию из внешних источников, следует иметь в виду, что запросы к этим базам выполняются под тем же логином, под которым производится соединение с основной базой.

#### Postgres

Если используется пользователь, отличный от `postgres`, необходимо дать следующие права на базу:

``` sql
GRANT CONNECT ON DATABASE
GRANT USAGE ON SCHEMA public
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA public 
GRANT EXECUTE ON ALL ROUTINES IN SCHEMA public
```

Также необходимо сменить владельца у [пользовательских таблиц и представлений](db/customer), выполнив хранимую процедуру `qp_change_contents_ownership`.

## Разделы описания

* [Основные таблицы и поля](db/main)
* [Пользовательские таблицы и представления](db/customer)
* [Дополнительные таблицы и поля для работы с контентами](db/extra)
* [Таблицы и поля, описывающие структуру бэкенда](db/structure)
* [Таблицы и поля, реализующие права доступа и аудит](db/access)
* [Прочие таблицы](db/other)
* [Хранимые процедуры](db/procedures)
* [Пользовательские функции](db/functions)
* [Представления](db/views)
